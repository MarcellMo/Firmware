<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S37T7U277">dhdx</span> = dhdx_calc(<span class="var type1" id="S38T3U280">u</span>,<span class="var type1" id="S39T3U281">v</span>,<span class="var type1" id="S40T3U282">w</span>,<span class="var type1" id="S41T3U283">phi</span>,<span class="var type1" id="S42T3U284">theta</span>,<span class="var type1" id="S43T3U285">psi</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T3:U8"><span class="var type1" id="S44T3U288">sphi</span> = <span class="mxinfo  sgl" id="T3:U10">sin(<span class="var type1" id="S41T3U291">phi</span>)</span></span>;   <span class="mxinfo " id="T3:U12"><span class="var type1" id="S46T3U294">cphi</span> = <span class="mxinfo  sgl" id="T3:U14">cos(<span class="var type1" id="S41T3U297">phi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T3:U16"><span class="var type1" id="S48T3U300">sthe</span> = <span class="mxinfo  sgl" id="T3:U18">sin(<span class="var type1" id="S42T3U303">theta</span>)</span></span>; <span class="mxinfo  sgl" id="T3:U20"><span class="var type1" id="S49T3U306">cthe</span> = <span class="mxinfo  sgl" id="T3:U22">cos(<span class="var type1" id="S42T3U309">theta</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T3:U24"><span class="var type1" id="S50T3U312">spsi</span> = <span class="mxinfo  sgl" id="T3:U26">sin(<span class="var type1" id="S43T3U315">psi</span>)</span></span>; <span class="mxinfo " id="T3:U28"><span class="var type1" id="S51T3U318">cpsi</span> = <span class="mxinfo  sgl" id="T3:U30">cos(<span class="var type1" id="S43T3U321">psi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T14:U32"><span class="mxinfo  sgl" id="T3:U33">abs(<span class="var type1" id="S49T3U327">cthe</span>)</span> &lt;= <span class="mxinfo  sgl" id="T3:U35">single(<span class="mxinfo  sgl" id="T16:U36">0.00001</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo  sgl" id="T3:U37"><span class="var type1" id="S49T3U333">cthe</span> = <span class="mxinfo  sgl" id="T3:U39">single(0.00001) * <span class="mxinfo  sgl" id="T3:U40">sign(<span class="var type1" id="S49T3U340">cthe</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T7:U42"><span class="var type1" id="S37T7U343">dhdx</span> = <span class="mxinfo  sgl" id="T7:U44">single([ <span class="mxinfo " id="T5:U45"><span class="mxinfo  sgl" id="T3:U46"><span class="var type1 sgl" id="S49T3U349">cthe</span>*<span class="var type1" id="S51T3U350">cpsi</span></span>, <span class="mxinfo  sgl" id="T3:U49"><span class="mxinfo  sgl" id="T3:U50"><span class="mxinfo  sgl" id="T3:U51"><span class="var type1" id="S44T3U354">sphi</span>*<span class="var type1" id="S48T3U355">sthe</span></span>*<span class="var type1" id="S51T3U356">cpsi</span></span>-<span class="mxinfo  sgl" id="T3:U55"><span class="var type1" id="S46T3U358">cphi</span>*<span class="var type1" id="S50T3U359">spsi</span></span></span>, <span class="mxinfo  sgl" id="T3:U58"><span class="mxinfo  sgl" id="T3:U59"><span class="mxinfo  sgl" id="T3:U60"><span class="var type1" id="S46T3U363">cphi</span>*<span class="var type1" id="S48T3U364">sthe</span></span>*<span class="var type1" id="S51T3U365">cpsi</span></span>+<span class="mxinfo  sgl" id="T3:U64"><span class="var type1" id="S44T3U367">sphi</span>*<span class="var type1" id="S50T3U368">spsi</span></span></span>,  <span class="mxinfo  sgl" id="T3:U67"><span class="mxinfo  sgl" id="T3:U68"><span class="mxinfo  sgl" id="T3:U69"><span class="mxinfo  sgl" id="T3:U70"><span class="mxinfo  sgl" id="T3:U71"><span class="mxinfo  sgl" id="T3:U72"><span class="var type1" id="S39T3U375">v</span>*<span class="var type1" id="S46T3U376">cphi</span></span>*<span class="var type1" id="S48T3U377">sthe</span></span>*<span class="var type1" id="S51T3U378">cpsi</span></span>+<span class="mxinfo  sgl" id="T3:U77"><span class="mxinfo  sgl" id="T3:U78"><span class="var type1" id="S39T3U381">v</span>*<span class="var type1" id="S44T3U382">sphi</span></span>*<span class="var type1" id="S50T3U383">spsi</span></span></span>-<span class="mxinfo  sgl" id="T3:U82"><span class="mxinfo  sgl" id="T3:U83"><span class="mxinfo  sgl" id="T3:U84"><span class="var type1" id="S40T3U387">w</span>*<span class="var type1" id="S44T3U388">sphi</span></span>*<span class="var type1" id="S48T3U389">sthe</span></span>*<span class="var type1" id="S51T3U390">cpsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U89"><span class="mxinfo  sgl" id="T3:U90"><span class="var type1" id="S40T3U393">w</span>*<span class="var type1" id="S46T3U394">cphi</span></span>*<span class="var type1" id="S50T3U395">spsi</span></span></span>, <span class="mxinfo  sgl" id="T3:U94"><span class="mxinfo  sgl" id="T3:U95"><span class="mxinfo  sgl" id="T3:U96"><span class="mxinfo  sgl" id="T3:U97"><span class="mxinfo  sgl" id="T3:U98">-<span class="var type1" id="S38T3U401">u</span></span>*<span class="var type1" id="S48T3U402">sthe</span></span>*<span class="var type1" id="S51T3U403">cpsi</span></span>+<span class="mxinfo  sgl" id="T3:U102"><span class="mxinfo  sgl" id="T3:U103"><span class="mxinfo  sgl" id="T3:U104"><span class="var type1" id="S39T3U407">v</span>*<span class="var type1" id="S44T3U408">sphi</span></span>*<span class="var type1 sgl" id="S49T3U409">cthe</span></span>*<span class="var type1" id="S51T3U410">cpsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U109"><span class="mxinfo  sgl" id="T3:U110"><span class="mxinfo  sgl" id="T3:U111"><span class="var type1" id="S40T3U414">w</span>*<span class="var type1" id="S46T3U415">cphi</span></span>*<span class="var type1 sgl" id="S49T3U416">cthe</span></span>*<span class="var type1" id="S51T3U417">cpsi</span></span></span>, <span class="mxinfo  sgl" id="T3:U116"><span class="mxinfo  sgl" id="T3:U117"><span class="mxinfo  sgl" id="T3:U118"><span class="mxinfo  sgl" id="T3:U119"><span class="mxinfo  sgl" id="T3:U120"><span class="mxinfo  sgl" id="T3:U121"><span class="mxinfo  sgl" id="T3:U122">-<span class="var type1" id="S38T3U425">u</span></span>*<span class="var type1 sgl" id="S49T3U426">cthe</span></span>*<span class="var type1" id="S50T3U427">spsi</span></span>-<span class="mxinfo  sgl" id="T3:U126"><span class="mxinfo  sgl" id="T3:U127"><span class="mxinfo  sgl" id="T3:U128"><span class="var type1" id="S39T3U431">v</span>*<span class="var type1" id="S44T3U432">sphi</span></span>*<span class="var type1" id="S48T3U433">sthe</span></span>*<span class="var type1" id="S50T3U434">spsi</span></span></span>-<span class="mxinfo  sgl" id="T3:U133"><span class="mxinfo  sgl" id="T3:U134"><span class="var type1" id="S39T3U437">v</span>*<span class="var type1" id="S46T3U438">cphi</span></span>*<span class="var type1" id="S51T3U439">cpsi</span></span></span>-<span class="mxinfo  sgl" id="T3:U138"><span class="mxinfo  sgl" id="T3:U139"><span class="mxinfo  sgl" id="T3:U140"><span class="var type1" id="S40T3U443">w</span>*<span class="var type1" id="S46T3U444">cphi</span></span>*<span class="var type1" id="S48T3U445">sthe</span></span>*<span class="var type1" id="S50T3U446">spsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U145"><span class="mxinfo  sgl" id="T3:U146"><span class="var type1" id="S40T3U449">w</span>*<span class="var type1" id="S44T3U450">sphi</span></span>*<span class="var type1" id="S51T3U451">cpsi</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">    <span class="mxinfo " id="T5:U150"><span class="mxinfo  sgl" id="T3:U151"><span class="var type1 sgl" id="S49T3U454">cthe</span>*<span class="var type1" id="S50T3U455">spsi</span></span>, <span class="mxinfo  sgl" id="T3:U154"><span class="mxinfo  sgl" id="T3:U155"><span class="mxinfo  sgl" id="T3:U156"><span class="var type1" id="S44T3U459">sphi</span>*<span class="var type1" id="S48T3U460">sthe</span></span>*<span class="var type1" id="S50T3U461">spsi</span></span>+<span class="mxinfo  sgl" id="T3:U160"><span class="var type1" id="S46T3U463">cphi</span>*<span class="var type1" id="S51T3U464">cpsi</span></span></span>, <span class="mxinfo  sgl" id="T3:U163"><span class="mxinfo  sgl" id="T3:U164"><span class="mxinfo  sgl" id="T3:U165"><span class="var type1" id="S46T3U468">cphi</span>*<span class="var type1" id="S48T3U469">sthe</span></span>*<span class="var type1" id="S50T3U470">spsi</span></span>-<span class="mxinfo  sgl" id="T3:U169"><span class="var type1" id="S44T3U472">sphi</span>*<span class="var type1" id="S51T3U473">cpsi</span></span></span>,  <span class="mxinfo  sgl" id="T3:U172"><span class="mxinfo  sgl" id="T3:U173"><span class="mxinfo  sgl" id="T3:U174"><span class="mxinfo  sgl" id="T3:U175"><span class="mxinfo  sgl" id="T3:U176"><span class="mxinfo  sgl" id="T3:U177"><span class="var type1" id="S39T3U480">v</span>*<span class="var type1" id="S46T3U481">cphi</span></span>*<span class="var type1" id="S48T3U482">sthe</span></span>*<span class="var type1" id="S50T3U483">spsi</span></span>-<span class="mxinfo  sgl" id="T3:U182"><span class="mxinfo  sgl" id="T3:U183"><span class="var type1" id="S39T3U486">v</span>*<span class="var type1" id="S44T3U487">sphi</span></span>*<span class="var type1" id="S51T3U488">cpsi</span></span></span>-<span class="mxinfo  sgl" id="T3:U187"><span class="mxinfo  sgl" id="T3:U188"><span class="mxinfo  sgl" id="T3:U189"><span class="var type1" id="S40T3U492">w</span>*<span class="var type1" id="S44T3U493">sphi</span></span>*<span class="var type1" id="S48T3U494">sthe</span></span>*<span class="var type1" id="S50T3U495">spsi</span></span></span>-<span class="mxinfo  sgl" id="T3:U194"><span class="mxinfo  sgl" id="T3:U195"><span class="var type1" id="S40T3U498">w</span>*<span class="var type1" id="S46T3U499">cphi</span></span>*<span class="var type1" id="S51T3U500">cpsi</span></span></span>, <span class="mxinfo  sgl" id="T3:U199"><span class="mxinfo  sgl" id="T3:U200"><span class="mxinfo  sgl" id="T3:U201"><span class="mxinfo  sgl" id="T3:U202"><span class="mxinfo  sgl" id="T3:U203"><span class="mxinfo  sgl" id="T3:U204">-<span class="var type1" id="S38T3U507">u</span></span>*<span class="var type1" id="S48T3U508">sthe</span></span>*<span class="var type1" id="S50T3U509">spsi</span></span>+<span class="mxinfo  sgl" id="T3:U208"><span class="mxinfo  sgl" id="T3:U209"><span class="mxinfo  sgl" id="T3:U210"><span class="var type1" id="S39T3U513">v</span>*<span class="var type1" id="S44T3U514">sphi</span></span>*<span class="var type1 sgl" id="S49T3U515">cthe</span></span>*<span class="var type1" id="S50T3U516">spsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U215"><span class="mxinfo  sgl" id="T3:U216"><span class="var type1" id="S39T3U519">v</span>*<span class="var type1" id="S46T3U520">cphi</span></span>*<span class="var type1" id="S51T3U521">cpsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U220"><span class="mxinfo  sgl" id="T3:U221"><span class="mxinfo  sgl" id="T3:U222"><span class="var type1" id="S40T3U525">w</span>*<span class="var type1" id="S46T3U526">cphi</span></span>*<span class="var type1 sgl" id="S49T3U527">cthe</span></span>*<span class="var type1" id="S50T3U528">spsi</span></span></span>, <span class="mxinfo  sgl" id="T3:U227"><span class="mxinfo  sgl" id="T3:U228"><span class="mxinfo  sgl" id="T3:U229"><span class="mxinfo  sgl" id="T3:U230"><span class="mxinfo  sgl" id="T3:U231"><span class="mxinfo  sgl" id="T3:U232"><span class="var type1" id="S38T3U535">u</span>*<span class="var type1 sgl" id="S49T3U536">cthe</span></span>*<span class="var type1" id="S51T3U537">cpsi</span></span>+<span class="mxinfo  sgl" id="T3:U236"><span class="mxinfo  sgl" id="T3:U237"><span class="mxinfo  sgl" id="T3:U238"><span class="var type1" id="S39T3U541">v</span>*<span class="var type1" id="S44T3U542">sphi</span></span>*<span class="var type1" id="S48T3U543">sthe</span></span>*<span class="var type1" id="S51T3U544">cpsi</span></span></span>-<span class="mxinfo  sgl" id="T3:U243"><span class="mxinfo  sgl" id="T3:U244"><span class="var type1" id="S39T3U547">v</span>*<span class="var type1" id="S46T3U548">cphi</span></span>*<span class="var type1" id="S50T3U549">spsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U248"><span class="mxinfo  sgl" id="T3:U249"><span class="mxinfo  sgl" id="T3:U250"><span class="var type1" id="S40T3U553">w</span>*<span class="var type1" id="S46T3U554">cphi</span></span>*<span class="var type1" id="S48T3U555">sthe</span></span>*<span class="var type1" id="S51T3U556">cpsi</span></span></span>+<span class="mxinfo  sgl" id="T3:U255"><span class="mxinfo  sgl" id="T3:U256"><span class="var type1" id="S40T3U559">w</span>*<span class="var type1" id="S44T3U560">sphi</span></span>*<span class="var type1" id="S50T3U561">spsi</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">    <span class="mxinfo " id="T5:U260"><span class="mxinfo  sgl" id="T3:U261">-<span class="var type1" id="S48T3U564">sthe</span></span>, <span class="mxinfo  sgl" id="T3:U263"><span class="var type1" id="S44T3U566">sphi</span>*<span class="var type1 sgl" id="S49T3U567">cthe</span></span>, <span class="mxinfo  sgl" id="T3:U266"><span class="var type1" id="S46T3U569">cphi</span>*<span class="var type1 sgl" id="S49T3U570">cthe</span></span>, <span class="mxinfo  sgl" id="T3:U269"><span class="mxinfo  sgl" id="T3:U270"><span class="mxinfo  sgl" id="T3:U271"><span class="var type1" id="S39T3U574">v</span>*<span class="var type1" id="S46T3U575">cphi</span></span>*<span class="var type1 sgl" id="S49T3U576">cthe</span></span>-<span class="mxinfo  sgl" id="T3:U275"><span class="mxinfo  sgl" id="T3:U276"><span class="var type1" id="S40T3U579">w</span>*<span class="var type1" id="S44T3U580">sphi</span></span>*<span class="var type1 sgl" id="S49T3U581">cthe</span></span></span>, <span class="mxinfo  sgl" id="T3:U280"><span class="mxinfo  sgl" id="T3:U281"><span class="mxinfo  sgl" id="T3:U282"><span class="mxinfo  sgl" id="T3:U283">-<span class="var type1" id="S38T3U586">u</span></span>*<span class="var type1 sgl" id="S49T3U587">cthe</span></span>-<span class="mxinfo  sgl" id="T3:U286"><span class="mxinfo  sgl" id="T3:U287"><span class="var type1" id="S39T3U590">v</span>*<span class="var type1" id="S48T3U591">sthe</span></span>*<span class="var type1" id="S44T3U592">sphi</span></span></span>-<span class="mxinfo  sgl" id="T3:U291"><span class="mxinfo  sgl" id="T3:U292"><span class="var type1" id="S40T3U595">w</span>*<span class="var type1" id="S46T3U596">cphi</span></span>*<span class="var type1" id="S48T3U597">sthe</span></span></span>, <span class="mxinfo  sgl" id="T3:U296">0</span></span>])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
